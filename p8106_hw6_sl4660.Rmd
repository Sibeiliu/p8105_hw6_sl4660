---
title: "hw6_sl4660"
author: "Sibei Liu"
date: "2019/11/24"
output: github_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo= TRUE,
                      message=FALSE,warning=FALSE
                      )
```
# Problem 1


```{r}
library(tidyverse)
library(modelr)
library(mgcv)
```

```{r}
child_weight=read_csv("./data/birthweight.csv") %>% 
  drop_na() %>% 
  mutate(
 babysex=factor(babysex,levels=c(1,2),labels=c("male","female")),
 frace=factor(frace,levels=c(1,2,3,4,8,9),labels=c( "White", "Black", "Asian", "Puerto Rican","Other", "Unknown")),
 mrace=factor(mrace,levels=c(1,2,3,4,8),labels=c( "White", "Black", "Asian", "Puerto Rican","Other")),
 malform=factor(malform,levels=c(0,1),labels=c("absent","present"))
)
```

## Let's build a model
Here is my model building process
First add all variables into the model(like backward method)
```{r}
rm1=lm(bwt~.,data=child_weight)
summary(rm1)
```
then remove the variable with p_value smaller than 0.05, then the babysex, bhead, blength,delwt,gaweeks,mrace,parity,smoken retains. Next, re-fit the model with above fitered variables.

```{r}
rm1_1=lm(bwt~babysex+bhead+blength+delwt+gaweeks+mrace+parity+smoken,data=child_weight)
summary(rm1_1)
```
We find all variables in this model is significant.
That is what I will use.

## The plot of model residual

```{r}
add_child_weight=child_weight %>% 
  add_predictions(rm1_1) %>% 
  add_residuals (rm1_1) 

  ggplot(add_child_weight,aes(x = pred, y = resid)) + 
    geom_point(alpha = 0.3) +
  labs(
        title = " Residuals vs. Predicted Values",
        x = "Predicted Birthweight (g)",
        y = "Residuals"
      )+
 geom_hline(yintercept = 0,col = "red",linetype = "dashed")
```

